!function(){"use strict";var t={baseUrl:"https://www.printful.com",appName:"printful",getCurrentUrl:function(){var t="";if(document.currentScript)t=document.currentScript.src;else for(var e=document.getElementsByTagName("script"),n=0;n<e.length;n++){if(/shopify-product-customizer.js/i.test(e[n].src)){t=e[n].src;break}}var i=t.indexOf("?");if(i>0&&(t=t.substring(0,i)),t){if(-1==t.indexOf(this.appName)||-1!==t.indexOf("cdn.printful.com"))return this.baseUrl;var s="http://";0==t.indexOf("http://")&&(t=t.replace("http://","")),0==t.indexOf("https://")&&(t=t.replace("https://",""),s="https://"),0==t.indexOf("//")&&(t=t.replace("//",""),s="https://");var r=t.split("/").shift();r&&(this.baseUrl=s+r)}return this.baseUrl}},e={currentLocale:null,translations:{"Personalize design":{es:"Personalizar diseño",fr:"Personnaliser le design",de:"Design personalisieren",it:"Personalizza le grafiche",ja:"デザインをカスタマイズ"},"Create a personalized design":{es:"Crear diseño personalizado",fr:"Créer un design personnalisé",de:"Erstelle ein personalisiertes Design",it:"Crea grafiche personalizzate",ja:"カスタムデザインを追加"}},translate:function(t){return!this.currentLocale&&document&&document.documentElement&&(this.currentLocale=document.documentElement.lang),this.currentLocale=this.currentLocale?this.currentLocale:"en",this.translations[t]&&this.translations[t][this.currentLocale]?this.translations[t][this.currentLocale]:t}};({settings:{baseUrl:"https://www.printful.com",buttonText:e.translate("Personalize design")},storeUrl:null,form:null,modal:null,submitBtn:null,customizeButton:null,init:function(){this.settings.baseUrl=t.getCurrentUrl(),this.settings.iframeUrl=this.settings.baseUrl+"/product-customizer/",this.storeUrl=void 0!==Shopify.shop?Shopify.shop:null;var e=document.querySelectorAll('form[action$="/cart/add"]');if(0!==e.length){this.form=e[0];var n=this.form.querySelectorAll('[type="submit"]');n.length>0&&(this.submitBtn=n[0]),this.buttonExists()?(this.customizeButton=this.getButton(),this.initButtonEvents()):document.querySelector(".pf-customisable-product")&&(this.insertButton(),this.initButtonEvents())}},insertButton:function(){this.customizeButton=this.createButton(),this.submitBtn.parentNode.insertBefore(this.customizeButton,this.submitBtn.nextSibling)},initButtonEvents:function(){this.customizeButton.onclick=this.onCustomizeClick.bind(this),this.submitBtn&&(this.customizeButton.disabled=this.submitBtn.disabled),this.form.addEventListener("change",function(t){["SELECT","INPUT"].indexOf(-1!==t.target.tagName.toUpperCase())&&setTimeout(function(){this.customizeButton.disabled=this.submitBtn.disabled}.bind(this),40)}.bind(this),!1)},getButton:function(){return document.getElementById("pfCustomizeProductBtn")},buttonExists:function(){return!!this.getButton()},createButton:function(){var t=document.createElement("button");return t.innerText=this.settings.buttonText,t.setAttribute("class","btn button"),t.setAttribute("style","margin: 5px 0;"),t.setAttribute("id","pfCustomizeProductBtn"),t},onCustomizeClick:function(t){t.preventDefault();var e=!1,n=this.form.querySelectorAll('select[name="id"]');if(n.length>0)e=n[0].options[n[0].selectedIndex].value;else{var i=this.form.querySelectorAll('input[name="id"]');if(0==i.length)return;e=i[0].value}if(e){var s=this.settings.iframeUrl+"?store="+this.storeUrl+"&variant="+e;document.body.appendChild(this.createModal(s)),this.listenForResponse()}},listenForResponse:function(){var t=window.addEventListener?"addEventListener":"attachEvent";(0,window[t])("attachEvent"===t?"onmessage":"message",function(t){t.origin===this.settings.baseUrl&&void 0!==t.data.action&&"PFProductCustomized"===t.data.action&&this.onCustomDesignSave(t.data.hash)}.bind(this))},onCustomDesignSave:function(t){if(t){var e,n=this.form.querySelectorAll('[name="properties[customisationId]"]');n.length>0?e=n[0]:((e=document.createElement("input")).type="hidden",e.name="properties[customisationId]",this.form.appendChild(e)),e.value=t}this.form.submit()},createModal:function(t){this.closeModal();var n=!1,i=!(!window.navigator||!window.navigator.userAgent)&&window.navigator.userAgent;i&&i.match(/iPhone|iPad|iPod/i)&&(n=!0);var s=document.createElement("div");s.className="pf-customize-modal",s.setAttribute("style","position: fixed; z-index: 2147483648; padding: 20px; top: 0; width: 100%; height: 100%; left: 0; background: rgba(0, 0 , 0, 0.6); box-sizing: border-box;");var r=document.createElement("div");r.setAttribute("style","padding: 15px; border-bottom: 1px solid #e5e5e5; overflow:hidden; position:absolute; top:0; left:0; width:100%; box-sizing: border-box;");var o=document.createElement("button");o.onclick=this.closeModal.bind(this),o.setAttribute("style","height:30px; width:30px; cursor:pointer; border:0px; background:0 0; padding:0; -webkit-appearance:none; color:#000; float:right; background:none;");var a=document.createElement("img");a.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAAXNSR0IArs4c6QAAAgVJREFUaAXtmU2KwkAQhZ0hQbyDu7mIB3PhwoN5EXfeIYguJo9JQRMydurnNYxTDTH+dNWr71VD2mSzyZEOpAPpQDqQDqQD6UA6kA6kA80dOJ1O++Px+NVKGFrQ9Oh9WoMhPAzD5fF4XFpAQwNa0PRAf1iABXaMle7e+r4/nM/nqyVfLUZgx3nS3etutzuMddxqsfPf1cALsJKTAr0AK3omaPWSfj6f21ERx3zso5f3C1hob6da5nW8/KzuMLJVCgnpNEvDBMyGZsGibjMwC5oJ6waOhmbDhgBHQbeADQP2QreCDQW2QreEDQfWQreGpQCvhcY8bFTGk2wX8ZWMkGu5JCvPrstSmWj+vta9aX5TWGjSgJG8Ao0p80HrrAhRgSGigKbDoh468EroJrCoRf1vCUF/edA7/K+WtAJWFg19adM6XIGVWzPvcVmqweL+F1r6FhuPNbBys08zV9a89xy6pC0AlhgPdBiwp3BPrBY+BDii4Igca+DdwJGFRub6Dd4FzCiQkbOENwMzC2PmNgEzC5JusDTUwKxCBLQ8M7TU/5a6rruPReGYj/B9MDYo065MtqKl5n2qpfyu+l7dYWRceIIYDltWvtBp05ND5DQBI7CA3jKfDUMLo4C+W58N/2RyvAIahThSqEKhBU1VUE5OB9KBdCAdSAfSgXQgHUgH0oEQB74BG1sUIwNoL3cAAAAASUVORK5CYII=",a.setAttribute("style","height:30px; width:30px;"),o.appendChild(a),r.appendChild(o);var d=document.createElement("h4");d.className="product-customizer__header-title",d.setAttribute("style","float: left;font-weight:bold;font-size:23px;color:#222;line-height:30px;margin:0px;"),d.innerText=e.translate("Create a personalized design"),r.appendChild(d);var l=document.createElement("div");l.setAttribute("style","background-color: #fff; width: 100%; height: 100%;overflow:hidden;position:relative"),l.appendChild(r);var u=document.createElement("style");u.innerHTML="@media screen and (max-width: 768px) { .product-customizer__header-title {font-size: 16px !important;} }",l.appendChild(u),s.appendChild(l);var c=document.createElement("iframe");if(c.src=t,c.width="100%",c.height="100%",n){var h=document.createElement("div");h.setAttribute("style","-webkit-overflow-scrolling: touch; overflow: scroll; height: 100%; top: 61px; box-sizing: border-box; position: absolute; width: 100%; padding-bottom: 60px;"),c.setAttribute("style","border: 0; box-sizing: border-box;"),h.appendChild(c),l.appendChild(h)}else c.setAttribute("style","border: 0; padding-top: 60px; box-sizing: border-box;"),l.appendChild(c);return this.modal=s,s},closeModal:function(){this.modal&&(this.modal.parentNode.removeChild(this.modal),this.modal=null)}}).init();var n={settings:{baseUrl:"https://www.printful.com"},_customizeKeyStrings:["customisationId:","customisationId"],init:function(){this.settings.baseUrl=t.getCurrentUrl(),this._processCustomizedImages();var e=this;new MutationObserver(function(t){t.forEach(function(){e._processCustomizedImages()})}).observe(document.body,{childList:!0,subtree:!0})},_processCustomizedImages:function(){var t=document.querySelectorAll('form[action="/cart"]');this._replaceImagesInElement(t)},_replaceImagesInElement:function(t){for(var e=0;e<t.length;e++){var n=t[e];n.classList.contains("pf-form-processed")||(n.classList.add("pf-form-processed"),this._parseElement(n))}},_parseElement:function(t){for(var e=t.childNodes,n=0;n<e.length;n++){var i=e[n];i.nodeType==Node.TEXT_NODE?this._findAndRemoveCustomizeKeyInfo(i):this._parseElement(i)}},_findAndRemoveCustomizeKeyInfo:function(t){for(var e=0;e<this._customizeKeyStrings.length;e++){var i=this._customizeKeyStrings[e];-1!=t.textContent.indexOf(i)&&(t.textContent=t.textContent.replace(i,""))}if(-1!=t.textContent.indexOf("pfc_")){var s=t.textContent.indexOf("pfc_"),r=t.textContent.substring(s,s+32+4),o=r.substring(4,36);t.textContent=t.textContent.replace(r,""),this._findAndReplaceImage(t.parentNode,this.settings.baseUrl+n.LOADING_IMAGE_URL,!0),this._findAndReplaceLinkImage(t.parentNode,this.settings.baseUrl+n.LOADING_IMAGE_URL,!0),this._getImageForHash(o,t),0==t.parentNode.textContent.trim().length&&t.parentNode.tagName&&(t.parentNode.style.display="none")}},_getImageForHash:function(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(t,e,n){if(4==this.readyState&&200==this.status){var i=JSON.parse(this.responseText).result.image;i?(n._findAndReplaceImage(t.parentNode,i,!0),n._findAndReplaceLinkImage(t.parentNode,i,!0)):setTimeout(function(){n._getImageForHash(e,t)},2e3)}}.bind(n,e,t,this);var i=this.settings.baseUrl+"/rpc/product-customizer-rpc/get-thumb";n.open("POST",i,!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8"),n.send("hash="+t)},_findAndReplaceImage:function(t,e,n){return this._findAndReplaceLoop(t,e,n,function(t,e){return"IMG"==t.tagName&&(t.src=e,t.setAttribute("data-widths","[800]"),t.setAttribute("data-srcset",e+" 800w"),t.setAttribute("srcset",e+" 800w"),!0)})},_findAndReplaceLinkImage:function(t,e,n){return this._findAndReplaceLoop(t,e,n,function(t,e){return"A"==t.tagName&&t.style.backgroundImage.length>0&&(t.style.backgroundImage="url("+e+")",!0)})},_findAndReplaceLoop:function(t,e,n,i){if(!t)return!1;if(t.classList.contains("pf-form-processed"))return console.warn("Looks like image was not replaced"),!0;for(var s=0;s<t.children.length;s++){var r=t.children[s];if(i(r,e))return!0;if(this._findAndReplaceLoop(r,e,!1,i))return!0}return!!n&&this._findAndReplaceLoop(t.parentNode,e,!0,i)},LOADING_IMAGE_URL:"/static/images/product-customizer/loading.gif"};n.init()}();